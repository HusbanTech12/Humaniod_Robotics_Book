# Data Model: Digital Twin Simulation for Humanoid Robots

## Entity: Digital Twin Model
- **Attributes**:
  - model_id: string (unique identifier)
  - urdf_file_path: string (path to URDF file)
  - sdf_file_path: string (path to SDF file, if applicable)
  - joint_configurations: array of joint definitions
  - sensor_placements: array of sensor definitions
  - physical_properties: object (mass, inertia, dimensions)
- **Relationships**: Contains multiple Joint and Sensor entities
- **Validation**: URDF/SDF files must be valid and parseable

## Entity: Joint
- **Attributes**:
  - joint_name: string (unique within robot)
  - joint_type: enum (revolute, prismatic, fixed, etc.)
  - limits: object (min/max position, velocity, effort)
  - parent_link: string (link name)
  - child_link: string (link name)
  - position: float (current position)
  - velocity: float (current velocity)
- **Relationships**: Belongs to Digital Twin Model
- **Validation**: Joint limits must be within physical constraints

## Entity: Sensor
- **Attributes**:
  - sensor_name: string (unique within robot)
  - sensor_type: enum (lidar, depth_camera, imu, force_torque)
  - topic_name: string (ROS 2 topic for data output)
  - position: object (x, y, z coordinates relative to parent link)
  - orientation: object (quaternion representation)
  - noise_parameters: object (for realistic sensor simulation)
  - sensor_data: object (current sensor readings)
- **Relationships**: Belongs to Digital Twin Model
- **Validation**: Topic names must follow ROS 2 naming conventions

## Entity: Simulation Environment
- **Attributes**:
  - environment_id: string (unique identifier)
  - world_file_path: string (path to Gazebo world file)
  - gravity: object (x, y, z components)
  - physics_engine: string (name of physics engine)
  - simulation_parameters: object (real_time_factor, max_step_size, etc.)
- **Relationships**: Contains Digital Twin Model
- **Validation**: World file must be valid for Gazebo

## Entity: Visualization Environment
- **Attributes**:
  - visualization_id: string (unique identifier)
  - unity_scene_path: string (path to Unity scene)
  - rendering_quality: enum (low, medium, high, ultra)
  - synchronization_enabled: boolean (whether to sync with Gazebo)
  - visualization_settings: object (rendering parameters)
- **Relationships**: Maps to Simulation Environment
- **Validation**: Unity scene must be compatible with ROS 2 bridge

## Entity: Sensor Data Stream
- **Attributes**:
  - stream_id: string (unique identifier)
  - sensor_id: string (reference to Sensor entity)
  - topic_name: string (ROS 2 topic name)
  - data_type: string (message type in ROS 2)
  - data_frequency: float (Hz)
  - data_payload: object (actual sensor readings)
  - timestamp: datetime (when data was generated)
- **Relationships**: Generated by Sensor, consumed by ROS 2 nodes
- **Validation**: Data must match expected ROS 2 message format

## Entity: Control Command
- **Attributes**:
  - command_id: string (unique identifier)
  - target_joint: string (joint to control)
  - command_type: enum (position, velocity, effort)
  - command_value: float (desired value)
  - timestamp: datetime (when command was issued)
  - execution_status: enum (pending, executing, completed, failed)
- **Relationships**: Sent to Digital Twin Model
- **Validation**: Command values must be within joint limits

## State Transitions

### Digital Twin Model States
- `unloaded` → `loaded` (when URDF/SDF is successfully parsed)
- `loaded` → `configured` (when joints and sensors are set up)
- `configured` → `simulating` (when physics simulation starts)
- `simulating` → `paused` (when simulation is paused)
- `paused` → `simulating` (when simulation resumes)
- `simulating` → `stopped` (when simulation ends)

### Sensor States
- `inactive` → `active` (when sensor starts publishing data)
- `active` → `inactive` (when sensor stops publishing)
- `active` → `error` (when sensor fails)
- `error` → `active` (when sensor recovers)

### Simulation Environment States
- `stopped` → `starting` (when simulation is initializing)
- `starting` → `running` (when simulation is active)
- `running` → `paused` (when simulation is paused)
- `paused` → `running` (when simulation resumes)
- `running` → `stopped` (when simulation ends)